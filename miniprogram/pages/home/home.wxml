<view class="container">
  <view class="header">
    <view class="header-text">
      <text class="greeting">{{greeting}}</text>
      <text class="date">{{currentDate}}</text>
    </view>
    <image class="avatar" src="{{avatarUrl}}" mode="aspectFill" wx:if="{{avatarUrl}}"></image>
    <view class="avatar placeholder" wx:else>
      <text class="avatar-text">☉</text>
    </view>
  </view>

  <view class="daily-card" bindtap="onChangeTab" data-tab="daily" style="{{cardStyle}} color: {{cardTextColor}}">
    <view class="sparkles"></view>
    <view class="glow-effect"></view>

    <view class="share-btn" catchtap="showShareModal" style="color: {{cardTextColor}}; border-color: {{cardTextColor}}20">
      <text class="icon-share">分享</text>
    </view>

    <view class="card-content">
      <view class="score-section">
        <view class="score-box">
          <text class="score-label" style="color: {{cardTextColor}}80">运势评分</text>
          <text class="score-value" style="color: {{cardTextColor}}">{{shareData.score}}</text>
        </view>
        <view class="summary-box">
          <text class="summary-text" style="color: {{cardTextColor}}">{{shareData.summary}}</text>
        </view>
      </view>

      <view class="desc-box">
        <text class="desc-text" style="color: {{cardTextColor}}">{{shareData.description}}</text>
      </view>

      <view class="lucky-section" style="background: {{cardTextColor}}10">
        <view class="lucky-item">
          <view class="lucky-label-row">
            <text class="lucky-label" style="color: {{cardTextColor}}80">幸运色</text>
          </view>
          <text class="lucky-value" style="color: {{cardTextColor}}">{{shareData.lucky.color}}</text>
        </view>

        <view class="divider" style="background: {{cardTextColor}}20"></view>

        <view class="lucky-item">
          <view class="lucky-label-row">
            <text class="lucky-label" style="color: {{cardTextColor}}80">幸运数</text>
          </view>
          <text class="lucky-value" style="color: {{cardTextColor}}">{{shareData.lucky.number}}</text>
        </view>

        <view class="divider" style="background: {{cardTextColor}}20"></view>

        <view class="lucky-item">
          <view class="lucky-label-row">
            <text class="lucky-label" style="color: {{cardTextColor}}80">吉位</text>
          </view>
          <text class="lucky-value" style="color: {{cardTextColor}}">{{shareData.lucky.direction}}</text>
        </view>
      </view>
    </view>
  </view>

  <view class="quick-access">
    <view class="section-header">
      <text class="section-title">快速体验</text>
    </view>
    <view class="quick-access-grid">
      <view class="quick-access-item" bindtap="onNavigateToQuickAccess" data-type="synastry">
        <view class="quick-access-icon-box accent-love">
          <view class="quick-access-icon colored-icon" style="-webkit-mask-image: url('/images/icons/love.svg'); mask-image: url('/images/icons/love.svg');"></view>
        </view>
        <text class="quick-access-title">双人合盘</text>
        <text class="quick-access-subtitle">关系能量解析</text>
      </view>
      <view class="quick-access-item" bindtap="onNavigateToQuickAccess" data-type="cbt">
        <view class="quick-access-icon-box accent-psycho">
          <view class="quick-access-icon colored-icon" style="-webkit-mask-image: url('/images/icons/health.svg'); mask-image: url('/images/icons/health.svg');"></view>
        </view>
        <text class="quick-access-title">CBT日记</text>
        <text class="quick-access-subtitle">情绪觉察记录</text>
      </view>
      <view class="quick-access-item" bindtap="onNavigateToQuickAccess" data-type="ask">
        <view class="quick-access-icon-box accent-mystic">
          <view class="quick-access-icon colored-icon" style="-webkit-mask-image: url('/images/icons/relations.svg'); mask-image: url('/images/icons/relations.svg');"></view>
        </view>
        <text class="quick-access-title">AI问答</text>
        <text class="quick-access-subtitle">星象即时咨询</text>
      </view>
    </view>
  </view>

  <view class="my-chart">
    <view class="section-header">
      <text class="section-title">我的星盘</text>
    </view>
    <view class="my-chart-grid">
      <view class="my-chart-card" bindtap="onNavigateToChart" data-type="natal">
        <view class="my-chart-icon-box accent-gold">
          <view class="my-chart-icon colored-icon" style="-webkit-mask-image: url('/images/astro-symbols/sun.svg'); mask-image: url('/images/astro-symbols/sun.svg');"></view>
        </view>
        <text class="my-chart-title">本命盘解读</text>
        <text class="my-chart-subtitle">了解核心人格</text>
      </view>
      <view class="my-chart-card" bindtap="onNavigateToChart" data-type="kline">
        <view class="my-chart-icon-box accent-psycho">
          <view class="my-chart-icon colored-icon" style="-webkit-mask-image: url('/images/icons/career.svg'); mask-image: url('/images/icons/career.svg');"></view>
        </view>
        <text class="my-chart-title">人生k线图</text>
        <text class="my-chart-subtitle">命运起伏趋势</text>
      </view>
    </view>
  </view>

  <view class="recommendations">
    <view class="section-header">
      <text class="section-title">为你推荐</text>
    </view>
    <view class="recommendations-loading" wx:if="{{isLoadingRecommendations}}">
      <text class="loading-text">推荐生成中...</text>
    </view>
    <view class="recommendations-empty" wx:if="{{!isLoadingRecommendations && recommendations.length === 0}}">
      <text class="loading-text">暂无推荐</text>
    </view>
    <view class="recommendations-list" wx:if="{{!isLoadingRecommendations && recommendations.length > 0}}">
      <block wx:for="{{recommendations}}" wx:key="id">
        <view class="recommendation-card" bindtap="onNavigateToRecommendation" data-route="{{item.route}}">
          <view class="recommendation-icon-box {{item.accentClass}}">
            <view class="recommendation-icon colored-icon" style="-webkit-mask-image: url('{{item.icon}}'); mask-image: url('{{item.icon}}');"></view>
          </view>
          <view class="recommendation-text">
            <text class="recommendation-title">{{item.title}}</text>
            <text class="recommendation-subtitle">{{item.subtitle}}</text>
            <text class="recommendation-category">{{item.category}}</text>
          </view>
        </view>
      </block>
    </view>
  </view>

  <view class="modal-overlay" wx:if="{{showShareModal}}" bindtap="hideShareModal">
    <view class="modal-content" catchtap="preventBubble">
      <view class="modal-header">
        <view class="modal-sparkle"></view>
        <text class="modal-title">今日好运签</text>
        <text class="modal-date">{{shareData.date}}</text>
      </view>
      <view class="modal-body">
        <view class="modal-score-section">
          <text class="modal-score">{{shareData.score}}</text>
          <text class="modal-summary">{{shareData.summary}}</text>
        </view>
        <text class="modal-desc">"{{shareData.description}}"</text>
        <button class="save-btn" bindtap="onSaveShare">
          <text>保存并分享</text>
        </button>
      </view>
      <view class="close-btn" catchtap="hideShareModal">×</view>
    </view>
  </view>
</view>
