<view class="container">
  <!-- List View -->
  <view class="list-container" wx:if="{{!selectedReport}}">
    <!-- æœªç™»å½• -->
    <view wx:if="{{needLogin}}" class="empty-state">
      <text class="empty-title">ç™»å½•åæŸ¥çœ‹æ”¶è—çš„æŠ¥å‘Š</text>
      <view class="login-btn" bindtap="goToLogin">
        <text>å»ç™»å½•</text>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:elif="{{reports.length === 0 && !loading}}" class="empty-state">
      <text class="empty-title">æš‚æ— æ”¶è—</text>
      <text class="empty-desc">ä½ çš„åˆ†ææŠ¥å‘Šå°†ä¿å­˜åœ¨è¿™é‡Œ</text>
    </view>

    <!-- æŠ¥å‘Šåˆ—è¡¨ -->
    <view wx:for="{{reports}}" wx:key="id" class="report-card ink-border" bindtap="onSelectReport" data-report="{{item}}">
      <view class="card-header">
        <view class="tag {{item.typeClass}}">{{item.typeText}}</view>
        <text class="date-label">{{item.dateFormatted}}</text>
      </view>
      <text class="card-title font-ancient">{{item.title}}</text>
      <view class="card-footer">
        <text class="card-action">æŸ¥çœ‹è¯¦æƒ… ></text>
      </view>
    </view>
  </view>

  <!-- Detail View -->
  <scroll-view scroll-y class="detail-scroll" wx:else show-scrollbar="false">
    <!-- æŠ¥å‘Šå¤´éƒ¨ -->
    <view class="detail-hero">
      <view class="detail-hero-inner">
        <view class="detail-tag-row">
          <view class="tag {{selectedReport.typeClass}}">{{selectedReport.typeText}}</view>
          <text class="detail-date">{{selectedReport.date}}</text>
        </view>
        <text class="detail-title font-ancient">{{selectedReport.title}}</text>
        <view class="detail-stat-row">
          <text class="detail-stat">å…± {{selectedReport.moduleCount}} ä¸ªç« èŠ‚</text>
        </view>
      </view>
      <!-- æ°´å¢¨è£…é¥°çº¿ -->
      <view class="ink-divider"></view>
    </view>

    <!-- æ¨¡å—ç›®å½• -->
    <view class="toc-section" wx:if="{{selectedReport.moduleList.length > 1}}">
      <view class="toc-inner">
        <view class="toc-item" wx:for="{{selectedReport.moduleList}}" wx:key="id">
          <view class="toc-dot"></view>
          <text class="toc-text">{{item.title}}</text>
        </view>
      </view>
    </view>

    <!-- æ¨¡å—å¡ç‰‡ -->
    <view class="modules-container">
      <block wx:for="{{selectedReport.moduleList}}" wx:key="id">
        <view class="module-card" style="animation-delay: {{index * 60}}ms;">
          <!-- é¡¶éƒ¨è‰²æ¡ -->
          <view class="module-accent module-accent-{{item.id}}"></view>
          <!-- æ¨¡å—å¤´ -->
          <view class="module-header">
            <view class="module-index-badge">
              <text class="module-index-text">{{index + 1}}</text>
            </view>
            <text class="module-title font-ancient module-title-{{item.id}}">{{item.title}}</text>
            <text class="module-rating" wx:if="{{item.rating}}">{{item.rating}}/10</text>
          </view>
          <!-- æ¨¡å—å†…å®¹ -->
          <view class="module-body">
            <rich-text class="markdown-content" nodes="{{item.htmlContent}}"></rich-text>
          </view>
        </view>
      </block>
    </view>

    <!-- åº•éƒ¨ -->
    <view class="detail-footer">
      <view class="security-badge">
        <text class="security-icon">ğŸ”’</text>
        <text class="security-label">æ­¤æŠ¥å‘Šå·²åŠ å¯†å­˜å‚¨ï¼Œä»…æ‚¨æœ¬äººå¯æŸ¥çœ‹</text>
      </view>
      <view class="back-btn" bindtap="onBack">
        <text class="back-btn-text">è¿”å›åˆ—è¡¨</text>
      </view>
    </view>

    <view style="height: 80rpx;"></view>
  </scroll-view>
</view>
