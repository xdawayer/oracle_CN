# 星语小程序 - 项目规范

## 页面加载优先级规则（最高优先级规范）

### 核心原则

用户完成资料填写并登入 App 后，页面数据加载必须遵循以下规则：

### 1. 默认加载顺序

用户登入后默认选中「首页」Tab，加载顺序如下：

1. **首页（Home）** — 最先加载，将首页中所有可视化内容（无需点击即可看到的内容）全部加载完成
2. **本我（Self）** — 首页加载完成后开始加载可视化内容
3. **今日（Daily）** — 本我加载完成后开始加载可视化内容
4. **发现（Discovery）** — 今日加载完成后开始加载可视化内容
5. **我的（Me）** — 最后加载可视化内容

每个 Tab 页只预加载「可视化内容」——即用户切换到该 Tab 后无需任何点击操作就能直接看到的内容。

### 2. 按需加载内容

以下内容**不参与预加载**，仅在用户主动点击/交互时才发起请求：

- 需要「点击查看详情」才能展示的内容
- 需要「点击展开」才能看到的内容
- 子页面、弹窗、详情页等二级内容

### 3. 用户交互优先级（最高优先级）

当用户主动发起操作时，**用户请求的优先级高于一切预加载任务**：

- 用户点击任何内容时，立即响应该请求，预加载任务让位
- 多个用户请求之间，按**最近点击优先**的原则排序（最近一次点击优先级最高）
- 用户主动切换 Tab 时，该 Tab 的加载优先级立即提升为最高

### 总结

```
优先级排序：用户主动点击 > 当前可见 Tab 预加载 > 后续 Tab 顺序预加载
预加载范围：仅可视化内容（不含需要点击才能展示的内容）
默认 Tab 顺序：首页 → 本我 → 今日 → 发现 → 我的
用户请求排序：最近点击优先级最高
```

---

## 项目结构

- **框架**: 微信小程序原生开发
- **云环境**: 微信云开发 (prod-6gnh6drs7858f443)
- **基础库**: 3.14.0

### Tab 页面

| Tab | 路径 | 说明 |
|-----|------|------|
| 首页 | `pages/home/home` | 主页仪表盘、每日运势、推荐内容 |
| 本我 | `pages/self/self` | 个人性格洞察 |
| 今日 | `pages/daily/daily` | 每日分析 |
| 发现 | `pages/discovery/discovery` | 内容发现与探索 |
| 我的 | `pages/me/me` | 账户与设置 |

### 关键目录

```
pages/          — 页面文件
components/     — 公共组件
services/       — 云函数调用与 API 服务
utils/          — 工具函数
data/           — 静态数据（协议文本等）
images/         — 图片资源
```
