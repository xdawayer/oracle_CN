# 优化「我的」页面完整体验

## 背景

当前「我的」页面（me）仅实现了基本框架：用户头部、VIP 卡片、统计卡片和菜单列表。但点击「VIP 会员」「积分充值」「编辑资料」等子功能后，只显示"该功能正在完善中"的占位文案。收藏报告（reports）和合盘记录（records）虽有独立页面，但 UI 风格不统一，缺乏东方禅意水墨极简美学。

后端已有 Stripe 支付系统（面向国际用户），但微信小程序需要对接**微信支付**体系，使用**人民币定价**。

## 目标

将「我的」模块从半成品状态提升为完整可用的全栈功能，覆盖以下 7 个子界面：

1. **我的主页**（me）— 个人中心入口
2. **个人资料编辑**（editProfile）— 头像、昵称、出生信息编辑
3. **VIP 会员中心**（subscription）— 订阅方案展示 + 开通/续费
4. **积分充值**（pointsRecharge）— 积分余额 + 充值档位 + 支付
5. **积分记录**（pointsHistory）— 积分收支明细
6. **收藏报告**（reports）— 已收藏报告列表
7. **合盘记录**（records）— 合盘历史记录列表

## 变更范围

### 变更 1：统一水墨极简视觉风格

**影响**：所有 7 个子界面

将全部页面统一为东方禅意水墨极简风格（黑白为主），严格遵循 `COLOR_SYSTEM_GUIDE.md`：
- 背景：`--paper-100` / `--paper-50`
- 文字：`--ink-deep` / `--ink-dark` / `--ink-light`
- 边框：`ink-border` 样式类
- 强调色：仅在关键操作按钮使用 `accent`（金色）
- 移除所有粉红色渐变、金棕色渐变等非规范配色
- 字体：标题使用 `font-ancient`（思源宋体），正文使用系统默认

### 变更 2：个人资料编辑页（全栈）

**影响**：`miniprogram/pages/me/` 子视图

实现完整的个人资料编辑功能：
- 头像更换（微信头像 + 相册选择）
- 昵称编辑
- 出生日期/时间/城市编辑（复用 onboarding 组件逻辑）
- 保存到后端 + 本地缓存同步
- 保存后刷新主页显示

### 变更 3：VIP 会员中心页（全栈）

**影响**：`miniprogram/pages/me/` 子视图、后端支付接口

实现完整的 VIP 订阅功能：
- 三档定价展示：连续包月 ¥9.9 / 季度会员 ¥45 / 年度会员 ¥128
- 原价划线展示：¥30 / ¥90 / ¥360
- 标签：「首月特惠」「最超值」
- 会员专属权益列表展示
- 对接微信支付完成订阅购买
- 已订阅用户显示续费界面（当前方案 + 到期日期 + 续费按钮）
- 同意《会员服务协议》勾选

### 变更 4：积分充值页（全栈）

**影响**：`miniprogram/pages/me/` 子视图、后端积分接口

实现积分充值功能：
- 当前余额展示（含刷新按钮）
- 六档充值选项：1/10/50/100/200/500 积分（1积分=¥1.00）
- 标签：「热门」「推荐」
- 对接微信支付完成充值
- 充值记录入口（跳转积分记录页）
- 同意《积分服务协议》勾选

### 变更 5：积分记录页

**影响**：新增子页面

实现积分收支明细：
- 表格展示：详情（描述）、日期、积分变更（+/-）
- 正数绿色、负数默认色
- 数据来源：后端积分流水 API
- 支持分页加载

### 变更 6：优化收藏报告页

**影响**：`miniprogram/pages/reports/`

在保持现有功能基础上统一视觉风格：
- 统一水墨极简卡片样式
- 报告类型标签（双人合盘/每日运势/本命解读等）使用规范色
- 日期显示优化
- 空状态设计

### 变更 7：优化合盘记录页

**影响**：`miniprogram/pages/records/`

在保持现有功能基础上统一视觉风格：
- 统一水墨极简卡片样式
- 匹配分数展示优化
- 关系类型标签
- 日期显示
- 空状态设计

### 变更 8：后端微信支付对接

**影响**：`backend/src/api/`、`backend/src/services/`

- 新增微信支付接口（JSAPI 支付）
- VIP 订阅创建/续费接口
- 积分充值接口
- 微信支付回调处理
- 积分流水查询接口
- 用户资料更新接口

## 不在此提案范围内

- 偏好设置页面
- 帮助与反馈页面
- 微信支付商户号申请（假设已完成）
- 国际支付（Stripe）的改造
- TabBar 导航的变更

## 风险与依赖

1. **微信支付商户号**：需已完成微信支付商户号注册和小程序绑定
2. **服务器签名**：微信支付需要后端生成签名，需部署到可访问的服务器
3. **与现有 Stripe 系统共存**：新的微信支付系统需与现有 Stripe 系统并行，通过支付渠道区分
