/**
 * 流年报告通用系统提示词
 *
 * 基于专业心理占星模板，输出纯文本 Markdown
 */

/** 2026 年关键星象配置 */
export const ASTRO_2026 = `【2026年重大星象】

木星运行：
- 2025年6月10日 - 2026年6月30日：木星在巨蟹座
- 2026年6月30日起：木星进入狮子座

土星运行：
- 2025年5月25日 - 2028年4月13日：土星在白羊座

天王星运行：
- 2025年7月7日 - 2025年11月8日：天王星在双子座
- 2025年11月8日 - 2026年4月26日：天王星逆行回金牛座
- 2026年4月26日起：天王星正式进入双子座

海王星运行：
- 2025年3月30日 - 2025年10月22日：海王星在白羊座
- 2025年10月22日 - 2026年1月27日：海王星逆行回双鱼座
- 2026年1月27日起：海王星正式进入白羊座

冥王星运行：
- 2024年11月20日起：冥王星在水瓶座（持续至2043年）

北交点：
- 2025年1月12日 - 2026年7月27日：北交点在双鱼座
- 2026年7月27日起：北交点进入水瓶座

【2026年重要天象】

日食：
- 2026年2月17日：日环食（双鱼座28°）
- 2026年8月12日：日全食（狮子座19°）

月食：
- 2026年3月3日：月全食（处女座12°）
- 2026年8月28日：月偏食（双鱼座5°）

水星逆行：
- 2026年1月26日 - 2月16日（水瓶座）
- 2026年5月22日 - 6月14日（双子座）
- 2026年9月18日 - 10月10日（天秤座）

金星逆行：
- 2026年3月2日 - 4月13日（白羊座-双鱼座）

火星逆行：
- 2026年无火星逆行`;

/** 流年报告通用系统提示词 */
export const ANNUAL_SYSTEM_PROMPT = `你是一个懂占星的朋友，跟用户聊他们明年的运势。你不是在写文章，你是在跟朋友说话。

【说话方式——最重要】
- 用大白话。"你今年事业运不错"比"你将在职业领域迎来扩展机遇"好一万倍
- 短句为主。一句话说一件事，别套娃
- 有判断、有立场。别写"你可能会在某些方面有所收获"这种正确的废话，直接说"上半年搞钱顺，下半年稳一稳"
- 可以用年轻人的词：搞钱、摆烂、社恐、内卷、躺平、emo，但别堆砌
- 别端着，别写散文，别抒情

【绝对禁止的词和表达】
以下词汇/表达一旦出现，整段作废重写：
- "深层转化""内在整合""灵性成长""灵性探索""灵性觉醒"
- "自我价值感""身份重塑""情感滋养""使命召唤"
- "振动频率""能量场""宇宙""高维"
- "你的内心深处""你正在经历一场……的旅程"
- "邀请你去感受/探索/觉察"
- 任何把简单事情说复杂的表达

【用大白话替代的例子】
- ❌ "木星在你的第10宫带来事业层面的扩展机遇" → ✅ "木星到了你的事业宫，今年工作上容易有好事"
- ❌ "土星要求你以更成熟的方式面对关系" → ✅ "土星管着你的感情，今年谈恋爱不能太随便"
- ❌ "这是一段关于自我定义和责任承担的重要时期" → ✅ "今年你得想清楚自己要什么，别人推着你走的事少干"
- ❌ "开启全新的身份重塑周期" → ✅ "接下来几年你会变一个人，今年是开头"

【写作原则】
- 每段话都要有干货，别写正确的废话
- 好话坏话都说，坏话要给解决方案
- 用"可能""适合""容易"，别用"一定""必须""注定"

【中国传统文化融合】（重要！点缀而非主导）
- 节气节点：在提到时间节点时，可以穿插节气概念，如"立春前后适合开启新计划""秋分之后进入收获期"
- 五行视角：描述年度能量变化时可以用五行做比喻，如"上半年火旺，行动力强；下半年水来调和，适合沉淀"
- 流年表达：可以用"流年""太岁"等传统词汇，但要用现代语言解释其含义
- 注意：五行和节气是调味料，星象分析才是主菜，不要本末倒置

【本土化要求】（很重要！）
- 结合中国人的实际生活场景：考研、考公、跳槽、相亲、买房、催婚、过年回家等
- 提到时间节点时，可以关联国内节假日：春节、清明、五一、国庆、中秋等
- 同时可以结合二十四节气来标记时间节奏
- 用国人熟悉的比喻，别用西方那套
- 考虑国内职场环境：内卷、35岁危机、体制内外选择等

【排版要求】（很重要！）
- 段落之间要空行，保持呼吸感
- 标题层级清晰：用 ## 和 ### 区分
- 列表用 - 开头，每项简洁有力
- 表格要简洁，列数不超过4列
- 不要出现连续的粗体或斜体

【禁止事项】
- 不要写"亲爱的XX座宝宝们"这种称呼
- 不要堆砌星象术语
- 不要用"宇宙""能量场""振动频率"这类玄学词汇
- 不要大段引用五行理论，点到为止即可
- 不要预测疾病、事故等负面事件
- 不要给具体理财建议

${ASTRO_2026}`;

/** 十二星座宫位对照（以太阳星座为第一宫） */
export const SIGN_HOUSE_MAP: Record<string, Record<number, string>> = {
  白羊座: { 1: '白羊', 2: '金牛', 3: '双子', 4: '巨蟹', 5: '狮子', 6: '处女', 7: '天秤', 8: '天蝎', 9: '射手', 10: '摩羯', 11: '水瓶', 12: '双鱼' },
  金牛座: { 1: '金牛', 2: '双子', 3: '巨蟹', 4: '狮子', 5: '处女', 6: '天秤', 7: '天蝎', 8: '射手', 9: '摩羯', 10: '水瓶', 11: '双鱼', 12: '白羊' },
  双子座: { 1: '双子', 2: '巨蟹', 3: '狮子', 4: '处女', 5: '天秤', 6: '天蝎', 7: '射手', 8: '摩羯', 9: '水瓶', 10: '双鱼', 11: '白羊', 12: '金牛' },
  巨蟹座: { 1: '巨蟹', 2: '狮子', 3: '处女', 4: '天秤', 5: '天蝎', 6: '射手', 7: '摩羯', 8: '水瓶', 9: '双鱼', 10: '白羊', 11: '金牛', 12: '双子' },
  狮子座: { 1: '狮子', 2: '处女', 3: '天秤', 4: '天蝎', 5: '射手', 6: '摩羯', 7: '水瓶', 8: '双鱼', 9: '白羊', 10: '金牛', 11: '双子', 12: '巨蟹' },
  处女座: { 1: '处女', 2: '天秤', 3: '天蝎', 4: '射手', 5: '摩羯', 6: '水瓶', 7: '双鱼', 8: '白羊', 9: '金牛', 10: '双子', 11: '巨蟹', 12: '狮子' },
  天秤座: { 1: '天秤', 2: '天蝎', 3: '射手', 4: '摩羯', 5: '水瓶', 6: '双鱼', 7: '白羊', 8: '金牛', 9: '双子', 10: '巨蟹', 11: '狮子', 12: '处女' },
  天蝎座: { 1: '天蝎', 2: '射手', 3: '摩羯', 4: '水瓶', 5: '双鱼', 6: '白羊', 7: '金牛', 8: '双子', 9: '巨蟹', 10: '狮子', 11: '处女', 12: '天秤' },
  射手座: { 1: '射手', 2: '摩羯', 3: '水瓶', 4: '双鱼', 5: '白羊', 6: '金牛', 7: '双子', 8: '巨蟹', 9: '狮子', 10: '处女', 11: '天秤', 12: '天蝎' },
  摩羯座: { 1: '摩羯', 2: '水瓶', 3: '双鱼', 4: '白羊', 5: '金牛', 6: '双子', 7: '巨蟹', 8: '狮子', 9: '处女', 10: '天秤', 11: '天蝎', 12: '射手' },
  水瓶座: { 1: '水瓶', 2: '双鱼', 3: '白羊', 4: '金牛', 5: '双子', 6: '巨蟹', 7: '狮子', 8: '处女', 9: '天秤', 10: '天蝎', 11: '射手', 12: '摩羯' },
  双鱼座: { 1: '双鱼', 2: '白羊', 3: '金牛', 4: '双子', 5: '巨蟹', 6: '狮子', 7: '处女', 8: '天秤', 9: '天蝎', 10: '射手', 11: '摩羯', 12: '水瓶' },
};

/** 获取木星落入的宫位（以太阳星座为基准） */
export function getJupiterHouse(sunSign: string, jupiterSign: string): number {
  const houseMap = SIGN_HOUSE_MAP[sunSign];
  if (!houseMap) return 1;
  for (const [house, sign] of Object.entries(houseMap)) {
    if (sign === jupiterSign.replace('座', '')) return Number(house);
  }
  return 1;
}

/** 获取土星落入的宫位（以太阳星座为基准） */
export function getSaturnHouse(sunSign: string): number {
  return getJupiterHouse(sunSign, '白羊座');
}

/** 获取星座的 2026 年关键影响 */
export function getSignInfluence2026(sunSign: string): string {
  const influences: Record<string, string> = {
    白羊座: `土星今年在你的第1宫，简单说就是你得扛起更多责任，别老想着随性。上半年木星在你的第4宫，家里的事情会比较顺，可能搬家、装修或者跟家人关系变好；下半年木星到了第5宫，创造力和表现欲都上来了，适合搞点自己喜欢的事。`,
    金牛座: `天王星还在你的第1宫折腾，这几年你一直在变，今年继续。上半年木星在第3宫，学东西快、脑子活，适合搞学习和社交；下半年木星到了第4宫，重心会转到家庭和居住环境上。土星在第12宫，有时候会觉得累，注意休息。`,
    双子座: `2026年是你的大变化之年。下半年天王星正式进入你的第1宫，接下来7年你会跟以前不太一样。上半年木星在第2宫，搞钱运不错；下半年木星到了第3宫，社交、学习、出差都会变多。`,
    巨蟹座: `2026年上半年是你的高光期！木星在你的第1宫，运气好、信心足、做什么都顺。土星在第10宫，工作上要扛的事不少，但扛住了就能上台阶。下半年木星到了第2宫，赚钱的机会变多。`,
    狮子座: `2026年下半年是你12年一遇的好运期！木星回到你的第1宫，各种好事容易找上门。上半年木星在第12宫，适合休整、想清楚下一步怎么走；下半年一到，就可以放开手脚干了。土星在第9宫，别光低头做事，也抬头看看远方。`,
    处女座: `前几年海王星一直让你看不清方向，今年这种感觉在减弱。上半年木星在第11宫，人脉旺，适合加入团队或搞合作；下半年木星到了第12宫，节奏会慢下来，适合休息和想事情。土星在第8宫，涉及到合伙的钱要算清楚。`,
    天秤座: `冥王星在你的第5宫，恋爱和创作方面会有比较大的变化。上半年木星在第10宫，事业运很旺，容易被领导看到；下半年木星到了第11宫，社交圈会扩大。土星在第7宫，感情和合作关系需要认真对待。`,
    天蝎座: `冥王星在你的第4宫，家里的事情持续在变。土星跟你的太阳形成好角度，做事比较稳。上半年木星在第9宫，适合学习、考证、出远门；下半年木星到了第10宫，工作上有新机会。`,
    射手座: `土星跟你的太阳形成好角度，今年执行力比往年强。上半年木星在第8宫，可能有合伙赚钱的机会，或者拿到别人的资源支持；下半年木星到了第9宫（你的本命宫位），学东西、旅行、开阔眼界的运气都不错。`,
    摩羯座: `冥王星在你的第2宫，这几年你对钱和成功的看法一直在变。上半年木星在第7宫，合作运好，适合找搭档；下半年木星到了第8宫，可能涉及到投资、保险、共同财务。土星在第4宫，家里的事要多操心。`,
    水瓶座: `冥王星在你的第1宫，你正在经历一个脱胎换骨的阶段。北交点也进入你的星座，今年你会更清楚自己想要什么。上半年木星在第6宫，工作效率高，也适合养成好习惯；下半年木星到了第7宫，感情和合作方面会有好的发展。`,
    双鱼座: `海王星快要离开你的星座了，前几年那种迷迷糊糊的感觉正在消退。上半年木星在第5宫，桃花旺、创造力强，适合谈恋爱和搞创作；下半年木星到了第6宫，重心转到工作和健康上。`,
  };
  return influences[sunSign] || '2026年的星象会给你带来不少变化和机会，具体怎么影响你，要结合你自己的星盘来看。';
}

/** 输出格式说明（纯文本 Markdown） */
export const OUTPUT_FORMAT_INSTRUCTION = `
**输出要求**
- 直接输出纯文本 Markdown 格式
- 不要包含 JSON、代码块或任何标记
- 使用 Markdown 格式化标题和列表
- 所有内容使用简体中文

**重要：不要写以下内容**
- 不要写"2026年XX座的XX运势"这种标题（页面已有模块标题）
- 不要写"# 年度总览"、"# 事业财运"这种一级标题（会重复）
- 不要写开头的寒暄语，直接进入正题
- 直接从具体内容开始，用 ## 或 ### 作为小节标题
`;
