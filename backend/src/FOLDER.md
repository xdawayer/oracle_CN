<!-- INPUT: 后端 src 目录结构与职责索引（含经典拆解数据刷新、报告积分购买、地理搜索优化与模块级流式输出）。 -->
<!-- OUTPUT: src 架构摘要与文件清单（含经典拆解数据刷新、报告积分购买、地理搜索记录与模块级流式输出）。 -->
<!-- POS: 后端源码目录索引；若更新此文件，务必更新本头注释与所属文件夹的 FOLDER.md。 -->
一旦我所属的文件夹有所变化，请更新我。

# 文件夹：backend/src

架构概要
- 存放后端 API 路由、服务与类型定义。
- prompts 管理 AI 指令，services 提供业务能力。
- 入口 index.ts 负责挂载路由与中间件。

文件清单
- FOLDER.md｜地位：目录索引文档｜功能：记录 src 目录结构与文件清单。
- index.ts｜地位：服务入口｜功能：初始化 Express 与路由挂载。

目录
- api｜地位：路由目录｜功能：API 端点处理。
- cache｜地位：缓存目录｜功能：缓存策略与 Redis 适配。
- data｜地位：数据源目录｜功能：数据源配置与常量。
- prompts｜地位：Prompt 目录｜功能：AI Prompt 注册与版本管理。
- services｜地位：服务目录｜功能：占星与 AI 业务能力实现。
- types｜地位：类型目录｜功能：API 请求/响应类型。
- utils｜地位：工具目录｜功能：通用辅助方法。

近期更新
- Geo 搜索端点支持多语言参数与结构化位置过滤。
- 报告购买改为积分消耗并接入订阅折扣定价。
- 经典拆解 Markdown 数据源刷新并生成新的 wiki-classics-markdown 输出。
- 本命盘/日运/CBT 端点接入紧凑摘要上下文并返回 Server-Timing。
- 本命盘/日运/合盘新增模块级 SSE stream 端点，支持分段交付 AI 模块。
- ask/cycle/wiki/pairing/synthetica 等 AI 端点补齐 Server-Timing 输出。
- 详情解读端点支持日运模块类型并允许按出生信息生成行运上下文。
- 详情解读端点新增本我页面 Big3/深度解析类型支持。
- 行运计算结果按出生信息+日期缓存 24 小时并跳过多余地理解析。
- 移除本命盘技术分析 AI 输出，仅保留真实计算数据渲染。
- 权益 V2 补充详情解锁与 GM 积分购买入口。
- GM 开发会话在无数据库时启用内存权益回退。
- 新增 GM 开发会话端点用于本地测试登录。
- 新增 API 响应统一包装中间件，补齐 success 字段。
- 新增 Wiki 经典书籍深度拆书报告与双语内容更新。
- 新增 Wiki 经典书籍静态数据与列表/详情端点。
- 百科深度解读 Prompt 扩展新增字段并引入生成覆盖层。
- wiki-generated 覆盖已写入全量 deep_dive 内容并清除占位符。
- 百科首页每日星象/灵感按日期缓存，确保当日一致。
- 百科数据源符号去 emoji 化，统一为 Unicode 图标。
- 合盘技术附录行星/相位清单补齐 Desc/IC 轴点并统一相位体。
- 合盘综述新增分区端点用于核心互动/练习工具箱/关系时间线的按需生成。
- CBT 分析 Prompt 加强行动建议可执行性要求。
- CBT 分析 Prompt 补充本命盘/行运/月相联动与星象觉察提示约束。
- 合盘新增 Highlights 分区、overview 上下文瘦身与本命盘缓存。
- 合盘 overview-section 分区参数解析支持大小写/空白容错与 highlight 别名。
- 合盘路线图 prompt 下线并移除 roadmap tab 映射。
- 新增心理占星百科 Wiki API 与数据源。
